(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    178980,       4822]
NotebookOptionsPosition[    171355,       4658]
NotebookOutlinePosition[    172063,       4683]
CellTagsIndexPosition[    172020,       4680]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Dispersion tensor routines", "Section",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"4c07a981-1626-465d-a361-89b0e114aaf8"],

Cell[CellGroupData[{

Cell["\<\
Dispersion tensor for general multispecies plasma.
Allows different plasma models for the conductivity of each species. 
Returns a 6 element list in the order
Eps{xx,yy,zz,xy,xz,yz}
Uses routines: SigmaCold, SigmaCoeff, SigmaMaxn

List model_List specifies which plasma model is used for a given species:
\t0 <-> cold plasma
\t1 <-> Warm plasma expanded to 2nd order
\t2 <-> Hot Plasma with full Bessel functions

Lists nmin_List and nmax_List specify how many harmonics are used in full \
Bessel model (model 2)
\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7883958096491337`*^9, 3.7883959325850267`*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"23d301b4-2a38-47bf-afa0-38ea5607f174"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EpsGeneral", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "nx_", ",", 
    "etaList_List", ",", "TList_List", ",", "nmin_List", ",", "nmax_List", 
    ",", "model_List", ",", 
    RowBox[{"print_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "T", ",", 
      "Eps", ",", 
      RowBox[{"z6", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", "fp", ",", "fc", ",", "v", ",", "SigmaSpecies", ",", 
      "EpsSpecies"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{"etaList", "\[LeftDoubleBracket]", 
         RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "6"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", "i", "]"}], "=", 
        RowBox[{
        "TList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "6", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "6", "]"}], "=", "2."}], ";", 
     RowBox[{"Eps", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EpsSpecies", "=", "z6"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"eta", "[", "i", "]"}], ">", "0."}], ",", 
          RowBox[{
           RowBox[{"fp", "=", 
            RowBox[{"N", "[", 
             FractionBox[
              RowBox[{"8.9787", " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{"n0", " ", 
                  RowBox[{"eta", "[", "i", "]"}], " ", 
                  SuperscriptBox[
                   RowBox[{"chg", "[", "i", "]"}], "2"]}], 
                 RowBox[{"mass", "[", "i", "]"}]]]}], 
              SuperscriptBox["10", "3"]], "]"}]}], ";", 
           RowBox[{"fc", "=", 
            RowBox[{"N", "[", 
             FractionBox[
              RowBox[{"2.79926", "B0", " ", 
               RowBox[{"chg", "[", "i", "]"}]}], 
              RowBox[{"mass", "[", "i", "]"}]], "]"}]}], ";", 
           RowBox[{"v", "=", 
            RowBox[{"N", "[", 
             SqrtBox[
              FractionBox[
               RowBox[{"T", "[", "i", "]"}], 
               RowBox[{
                RowBox[{"mass", "[", "i", "]"}], " ", "256"}]]], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "model", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               "==", "0"}], ",", 
             RowBox[{
              RowBox[{"EpsSpecies", "=", 
               RowBox[{"SigmaCold", "[", 
                RowBox[{"fp", ",", "fc", ",", "freq"}], "]"}]}], ";"}]}], 
            "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "model", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "==", "1"}], "&&", 
              RowBox[{"v", ">", "0"}]}], ",", 
             RowBox[{
              RowBox[{"SigmaSpecies", "=", 
               RowBox[{"SigmaCoeff", "[", 
                RowBox[{"fp", ",", "fc", ",", "freq", ",", "v", ",", "nz"}], 
                "]"}]}], ";", 
              RowBox[{"EpsSpecies", "=", 
               RowBox[{
                RowBox[{
                "SigmaSpecies", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", 
                RowBox[{"nx", " ", 
                 RowBox[{
                 "SigmaSpecies", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 SuperscriptBox["nx", "2"], " ", 
                 RowBox[{
                 "SigmaSpecies", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}]}]}], ";"}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "model", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "==", "1"}], "&&", 
              RowBox[{"v", "==", "0."}]}], ",", 
             RowBox[{"EpsSpecies", "=", 
              RowBox[{"SigmaCold", "[", 
               RowBox[{"fp", ",", "fc", ",", "freq"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "model", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "==", "2"}], "&&", 
              RowBox[{"v", ">", "0"}]}], ",", 
             RowBox[{
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"SigmaSpecies", "=", 
                  RowBox[{"SigmaMaxn", "[", 
                   RowBox[{
                   "fp", ",", "fc", ",", "freq", ",", "v", ",", "nz", ",", 
                    "nx", ",", "nHarmonic"}], "]"}]}], ";", 
                 RowBox[{"EpsSpecies", "=", 
                  RowBox[{"EpsSpecies", "+", "SigmaSpecies"}]}], ";"}], ",", 
                RowBox[{"{", 
                 RowBox[{"nHarmonic", ",", 
                  RowBox[{
                  "nmin", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                  "nmax", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ";"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "model", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "&&", 
              RowBox[{"v", "==", "0."}]}], ",", 
             RowBox[{"EpsSpecies", "=", 
              RowBox[{"SigmaCold", "[", 
               RowBox[{"fp", ",", "fc", ",", "freq"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"print", "\[Equal]", "True"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<\\n\\nEpsGeneral    species=\>\"", ",", "i", ",", 
                 "\"\<    model for this species =\>\"", ",", 
                 RowBox[{
                 "model", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Eps[i]=\>\"", ",", 
                 RowBox[{"Chop", "[", "EpsSpecies", "]"}]}], "]"}]}], ")"}]}],
             "]"}], ";"}]}], "]"}], ";", 
        RowBox[{"Eps", "=", 
         RowBox[{"Eps", "+", "EpsSpecies"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ";", "Eps"}]}], 
   "]"}]}]], "Input",
 PageBreakBelow->True,
 InitializationCell->True,
 CellChangeTimes->{{3.785591090817832*^9, 3.785591110164206*^9}, {
   3.7855911551909122`*^9, 3.7855911664854717`*^9}, {3.785591605083453*^9, 
   3.785591627675034*^9}, {3.785592458269969*^9, 3.785592461174286*^9}, {
   3.785592767661283*^9, 3.785592781527293*^9}, {3.78559340814047*^9, 
   3.785593417800983*^9}, 3.7855942746217747`*^9, {3.785594416135124*^9, 
   3.785594440148188*^9}, {3.78559450207983*^9, 3.785594504918193*^9}, {
   3.785594555986765*^9, 3.785594561223197*^9}, 3.785605269402439*^9, {
   3.788919324409381*^9, 3.78891934908923*^9}, 3.788919436410762*^9, {
   3.788919475406581*^9, 3.7889194855315723`*^9}, 3.788919572741743*^9, {
   3.7889196552091703`*^9, 3.788919678149393*^9}, 3.788919769454829*^9, {
   3.7889198306413317`*^9, 3.7889198417717667`*^9}, {3.7889199573851633`*^9, 
   3.788920006167225*^9}, {3.8758027125768967`*^9, 3.8758027304986887`*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"c66a0ab7-6d9d-4b31-a20e-ddb6d9566b99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Warm plasma dispersion tensor for Maxwellian plasma, including full Bessel \
functions.\nSums over species and cyclotron harmonics. \nReturns a 6 element \
list in the order\nEps{xx,yy,zz,xy,xz,yz}\nUses routine ",
 StyleBox["SigmaMaxn",
  FontFamily->"Courier",
  FontSize->12],
 "\n"
}], "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"93ba5263-cd61-4bb7-8943-8a4f731bae49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WarmEpsMaxwell", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "nx_", ",", 
    "etaList_List", ",", "TList_List", ",", "nmin_List", ",", "nmax_List", 
    ",", 
    RowBox[{"print_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "T", ",", 
      "Eps", ",", 
      RowBox[{"z6", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", "fp", ",", "fc", ",", "v", ",", "sig", ",", 
      "EpsSpecies"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", "i", "]"}], "=", 
        RowBox[{"TList", "\[LeftDoubleBracket]", 
         RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Eps", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EpsSpecies", "=", "z6"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"fp", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"8.9787", " ", 
            SqrtBox[
             FractionBox[
              RowBox[{"n0", " ", 
               RowBox[{"eta", "[", "i", "]"}], " ", 
               SuperscriptBox[
                RowBox[{"chg", "[", "i", "]"}], "2"]}], 
              RowBox[{"mass", "[", "i", "]"}]]]}], 
           SuperscriptBox["10", "3"]], "]"}]}], ";", 
        RowBox[{"fc", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"2.79926", " ", "B0", " ", 
            RowBox[{"chg", "[", "i", "]"}]}], 
           RowBox[{"mass", "[", "i", "]"}]], "]"}]}], ";", 
        RowBox[{"v", "=", 
         RowBox[{"N", "[", 
          SqrtBox[
           FractionBox[
            RowBox[{"T", "[", "i", "]"}], 
            RowBox[{
             RowBox[{"mass", "[", "i", "]"}], " ", "256"}]]], "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fp", " ", "v"}], ">", "0"}], ",", 
             RowBox[{"sig", "=", 
              RowBox[{"SigmaMaxn", "[", 
               RowBox[{
               "fp", ",", "fc", ",", "freq", ",", "v", ",", "nz", ",", "nx", 
                ",", "nHarmonic"}], "]"}]}], ",", 
             RowBox[{"sig", "=", "z6"}]}], "]"}], ";", 
           RowBox[{"EpsSpecies", "=", 
            RowBox[{"EpsSpecies", "+", "sig"}]}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"nHarmonic", ",", 
            RowBox[{"nmin", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{"nmax", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"print", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fp", " ", "v"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<\\n\\nEps full Bessel function, summed over harmonic    \
species=\>\"", ",", "i"}], "]"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Eps[i]=\>\"", ",", 
                 RowBox[{"Chop", "[", "EpsSpecies", "]"}]}], "]"}]}], ")"}], 
             ","}], "]"}], ")"}]}], "]"}], ";", 
        RowBox[{"Eps", "=", 
         RowBox[{"Eps", "+", "EpsSpecies"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", "Eps"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7856054644432573`*^9, 3.7856055115418167`*^9}, 
   3.785605605888041*^9, 3.78560566009571*^9, {3.785605987211866*^9, 
   3.7856060078558826`*^9}, {3.785606126875403*^9, 3.785606129447446*^9}, {
   3.785606379436399*^9, 3.785606394263898*^9}, 3.785606444901338*^9, {
   3.785606509828273*^9, 3.785606514789953*^9}, {3.785606897211927*^9, 
   3.785606920398335*^9}, {3.7856069524226103`*^9, 3.785607000967811*^9}, {
   3.785607061028982*^9, 3.785607094793521*^9}, {3.785607131896318*^9, 
   3.785607154978149*^9}, {3.788547903130622*^9, 3.7885479083132277`*^9}, {
   3.788547944070808*^9, 3.7885479499957*^9}, {3.7885482168171797`*^9, 
   3.788548223298053*^9}, {3.7885484495115023`*^9, 3.788548456980709*^9}, {
   3.788548679116611*^9, 3.788548685267837*^9}, {3.788548739778611*^9, 
   3.788548825067135*^9}, {3.875802759284575*^9, 3.875802773068355*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"bc747b7a-3cd6-41c9-9cde-b01b8465ef9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Numerical implementation of the Warm Plasma Conductivity Tensor - 4\[Pi]i/\
\[Omega] \[Sigma] for a single cyclotron harmonic n of a single isotropic \
Maxwellian species
Uses routines Zfun[z] and BesselI
\
\>", "Subsection",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"73492aab-32eb-4fee-a3b6-55d788c86d59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SigmaMaxn", "[", 
   RowBox[{
   "fp_", ",", "fc_", ",", "f_", ",", "v_", ",", "nz_", ",", "nx_", ",", 
    "n_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "z", ",", "z0", ",", "Z", ",", "b", ",", "gamma", ",", "eIbess", ",", 
      "eIbessp", ",", "Zf", ",", "Zfp", ",", " ", "sigma"}], "}"}], ",", 
    RowBox[{
     RowBox[{"b", "=", 
      FractionBox[
       RowBox[{"nx", " ", "v", " ", "f"}], 
       RowBox[{"fc", " ", 
        SqrtBox["2."]}]]}], ";", 
     RowBox[{"gamma", "=", 
      SuperscriptBox["b", "2"]}], ";", 
     RowBox[{"z", "=", 
      FractionBox[
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"n", " ", "fc"}], "f"]}], 
       RowBox[{"nz", " ", "v"}]]}], ";", 
     RowBox[{"z0", "=", 
      FractionBox["1", 
       RowBox[{"nz", " ", "v"}]]}], ";", 
     RowBox[{"Zf", "=", 
      RowBox[{"Zfun", "[", "z", "]"}]}], ";", 
     RowBox[{"Zfp", "=", 
      RowBox[{
       RowBox[{"-", "2."}], " ", 
       RowBox[{"(", 
        RowBox[{"1.", "+", 
         RowBox[{"z", " ", "Zf"}]}], ")"}]}]}], ";", 
     RowBox[{"eIbess", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "gamma"}]], " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{"n", ",", "gamma"}], "]"}]}], ",", "$MachinePrecision"}], 
       "]"}]}], ";", 
     RowBox[{"eIbessp", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "gamma"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"BesselI", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "gamma"}], "]"}], "-", 
           FractionBox[
            RowBox[{"n", " ", 
             RowBox[{"BesselI", "[", 
              RowBox[{"n", ",", "gamma"}], "]"}]}], "gamma"]}], ")"}]}], ",", 
        "$MachinePrecision"}], "]"}]}], ";", 
     RowBox[{"sigma", "=", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["fp", "2"], " ", "z0"}], 
        SuperscriptBox["f", "2"]], 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"eIbess", " ", 
           SuperscriptBox["n", "2"], " ", "Zf"}], "gamma"], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2."}], " ", "gamma", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "eIbess"}], "+", "eIbessp"}], ")"}]}], "+", 
            FractionBox[
             RowBox[{"eIbess", " ", 
              SuperscriptBox["n", "2"]}], "gamma"]}], ")"}], " ", "Zf"}], ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"eIbess", " ", "z", " ", "Zfp"}], ")"}]}], ",", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "eIbess"}], "+", "eIbessp"}], ")"}], " ", "n", " ", 
          "Zf"}], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "eIbess"}], " ", "n", " ", "Zfp"}], 
          RowBox[{
           SqrtBox["2."], " ", "b"}]], ",", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "/", 
           SqrtBox["2."]}], " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "eIbess"}], "+", "eIbessp"}], ")"}], " ", "Zfp"}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<gamma= \>\"", ",", " ", "gamma", ",", "\"\< zf = \>\"", ",", " ", 
        "zf", ",", " ", "\"\< zfp = \>\"", ",", " ", "\"\<  eIbess = \>\"", 
        ",", " ", "eIbess", ",", " ", "\"\<  eIbessp = \>\"", ",", " ", 
        "eIbessp", ",", " ", "\"\<  sigma[[1]] = \>\"", ",", " ", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\<  sigma[[2]] = \>\"", 
        ",", " ", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*)"}], 
     "\[IndentingNewLine]", "sigma"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7880326833619423`*^9, 3.788032746280981*^9}, 
   3.7886065167582617`*^9, {3.7886107754870033`*^9, 3.788611072796852*^9}, 
   3.7889182921960573`*^9, {3.788918364411706*^9, 3.788918373656765*^9}, {
   3.788918613944976*^9, 3.788918648439761*^9}, 3.788918921283392*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"30ff4dcc-20e6-4b1b-bf9c-a247d5314569"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Warm plasma dispersion tensor expanded to 2nd order in k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "\[Rho].",
 "  Summed over species and order k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "\[Rho]",
 ".  Returns a 6 element list Eps. in the order {xx,yy,zz,xy,xz,yz}\nUses \
routine WarmEpsCoeff\n"
}], "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"260a69c4-805b-437a-ac00-46c903af2668"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WarmEps", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "nx_", ",", 
    "etaList_List", ",", "TList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "T", ",", 
      "Eps", ",", 
      RowBox[{"z6", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", "fp", ",", "fc", ",", "v", ",", "EpsSpecies", ",", 
      "SigSpecies"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", "i", "]"}], "=", 
        RowBox[{"TList", "\[LeftDoubleBracket]", 
         RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Eps", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"8.9787", " ", 
            SqrtBox[
             FractionBox[
              RowBox[{"n0", " ", 
               RowBox[{"eta", "[", "i", "]"}], " ", 
               SuperscriptBox[
                RowBox[{"chg", "[", "i", "]"}], "2"]}], 
              RowBox[{"mass", "[", "i", "]"}]]]}], 
           SuperscriptBox["10", "3"]], "]"}]}], ";", 
        RowBox[{"fc", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"2.79926", " ", "B0", " ", 
            RowBox[{"chg", "[", "i", "]"}]}], 
           RowBox[{"mass", "[", "i", "]"}]], "]"}]}], ";", 
        RowBox[{"v", "=", 
         RowBox[{"N", "[", 
          SqrtBox[
           FractionBox[
            RowBox[{"T", "[", "i", "]"}], 
            RowBox[{
             RowBox[{"mass", "[", "i", "]"}], " ", "256"}]]], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fp", " ", "v"}], ">", "0"}], ",", 
          RowBox[{"SigSpecies", "=", 
           RowBox[{"SigmaCoeff", "[", 
            RowBox[{"fp", ",", "fc", ",", "freq", ",", "v", ",", "nz"}], 
            "]"}]}], ",", 
          RowBox[{"SigSpecies", "=", 
           RowBox[{"{", 
            RowBox[{"z6", ",", "z6", ",", "z6"}], "}"}]}]}], "]"}], ";", 
        RowBox[{"EpsSpecies", "=", 
         RowBox[{
          RowBox[{
          "SigSpecies", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "+", 
          RowBox[{"nx", " ", 
           RowBox[{
           "SigSpecies", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "+", 
          RowBox[{
           SuperscriptBox["nx", "2"], " ", 
           RowBox[{
           "SigSpecies", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}]}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fp", " ", "v"}], ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<\\n\\nEps 2nd order expansion, summed over harmonic    \
species=\>\"", ",", "i"}], "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fp", " ", "v"}], ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Eps[i]=\>\"", ",", 
            RowBox[{"Chop", "[", "EpsSpecies", "]"}]}], "]"}]}], "]"}], ";", 
        RowBox[{"Eps", "=", 
         RowBox[{"Eps", "+", "EpsSpecies"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", "Eps"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.87580285815658*^9, 3.875803113696836*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"b82aa548-fc2d-4d4a-91a7-ef510b0f427b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Expansion coefficients of warm plasma dispersion tensor expanded to 2nd \
order in k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "\[Rho].",
 "  Sums over species.  Returns a 3x6 element list of 0th, 1st and 2nd order \
k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 " ",
 "coefficients of Eps in the order\n{xx,yy,zz,xy,xz,yz}\nNote: To get total \
eps one must multiply by k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "^n and sum.\nUses routine SigmaCoeff\n"
}], "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"0aee45b7-8b52-485f-92d6-1ea03f441637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WarmEpsCoeff", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List", ",", 
    "TList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "T", ",", 
      "Eps", ",", 
      RowBox[{"z6", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", "fp", ",", "fc", ",", "v"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", "i", "]"}], "=", 
        RowBox[{"TList", "\[LeftDoubleBracket]", 
         RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Eps", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", "z6", ",", "z6"}], "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"8.9787", " ", 
            SqrtBox[
             FractionBox[
              RowBox[{"n0", " ", 
               RowBox[{"eta", "[", "i", "]"}], " ", 
               SuperscriptBox[
                RowBox[{"chg", "[", "i", "]"}], "2"]}], 
              RowBox[{"mass", "[", "i", "]"}]]]}], 
           SuperscriptBox["10", "3"]], "]"}]}], ";", 
        RowBox[{"fc", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"2.79926", " ", "B0", " ", 
            RowBox[{"chg", "[", "i", "]"}]}], 
           RowBox[{"mass", "[", "i", "]"}]], "]"}]}], ";", 
        RowBox[{"v", "=", 
         RowBox[{"N", "[", 
          SqrtBox[
           FractionBox[
            RowBox[{"T", "[", "i", "]"}], 
            RowBox[{
             RowBox[{"mass", "[", "i", "]"}], " ", "256"}]]], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fp", ">", "0."}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"v", ">", "0"}], ",", 
            RowBox[{"Eps", "=", 
             RowBox[{"Eps", "+", 
              RowBox[{"SigmaCoeff", "[", 
               RowBox[{"fp", ",", "fc", ",", "freq", ",", "v", ",", "nz"}], 
               "]"}]}]}], ",", 
            RowBox[{"Eps", "=", 
             RowBox[{"Eps", "+", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SigmaCold", "[", 
                 RowBox[{"fp", ",", "fc", ",", "freq"}], "]"}], ",", "z6", 
                ",", "z6"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"Eps", "=", "Eps"}]}], "]"}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", "Eps"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.788561994617453*^9, 3.788562004429131*^9}, {
   3.788562042319767*^9, 3.788562045160344*^9}, 3.788562612853834*^9, {
   3.7885634016446733`*^9, 3.788563504385684*^9}, 3.788563601744051*^9, {
   3.788563655203249*^9, 3.7885636593320103`*^9}, 3.788563689817408*^9, {
   3.78856382843606*^9, 3.788563829527225*^9}, {3.788563953611931*^9, 
   3.7885639697164373`*^9}, {3.7885642492823067`*^9, 3.788564250402712*^9}, {
   3.788565470309965*^9, 3.788565493368003*^9}, {3.788917921553795*^9, 
   3.788917934981925*^9}, {3.788917965066421*^9, 3.78891796920047*^9}, {
   3.8290428400753193`*^9, 3.829042904138659*^9}, 3.8758028680157843`*^9, 
   3.875803102880417*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"3de698c4-bc56-4519-941e-d3bf67251d33"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Numerical implementation of the Warm Plasma Conductivity Tensor - 4\[Pi]i/\
\[Omega] \[Sigma] for a single isotropic Maxwellian species
\
\>", "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"27cd580f-41b3-471b-8c55-6a8094217a30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SigmaCoeff", "[", 
   RowBox[{"fp_", ",", "fc_", ",", "f_", ",", "v_", ",", "nz_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"z", ",", "Z", ",", "b"}], "}"}], ",", 
    RowBox[{
     RowBox[{"b", "=", 
      FractionBox["fc", "f"]}], ";", 
     RowBox[{"z", "=", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "b"}]}], ",", 
         RowBox[{"1", "+", "b"}], ",", "1", ",", 
         RowBox[{"1", "-", "b"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "b"}]}]}], "}"}], 
       RowBox[{"nz", " ", "v"}]]}], ";", 
     RowBox[{"Z", "=", 
      RowBox[{"Zfun", "/@", "z"}]}], ";", 
     RowBox[{"N", "[", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["f", "2"]], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["fp", "2"], " ", 
         RowBox[{"z", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
               "Z", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "2"], "+", 
              FractionBox[
               RowBox[{
               "Z", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               "2"]}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{
               "Z", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "2"], "+", 
              FractionBox[
               RowBox[{
               "Z", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               "2"]}], ",", 
             RowBox[{"2", " ", 
              RowBox[{
              "z", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{
                 "z", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                 " ", 
                 RowBox[{
                 "Z", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
               RowBox[{
               "Z", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              "+", 
              RowBox[{
               FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
               RowBox[{
               "Z", "\[LeftDoubleBracket]", "4", 
                "\[RightDoubleBracket]"}]}]}], ",", "0", ",", "0"}], "}"}], 
           ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"fc", " ", 
              SqrtBox["2"]}]], 
            RowBox[{"(", 
             RowBox[{"f", " ", "v", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    "z", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    "Z", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], 
                   SqrtBox["2"]]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "z", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "Z", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], 
                  SqrtBox["2"]]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{
                    "z", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    "Z", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], 
                   SqrtBox["2"]]}], "+", 
                 RowBox[{"\[ImaginaryI]", " ", 
                  SqrtBox["2"], " ", 
                  RowBox[{
                  "z", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   " ", 
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 FractionBox[
                  RowBox[{"\[ImaginaryI]", " ", 
                   RowBox[{
                   "z", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "Z", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], 
                  SqrtBox["2"]]}]}], "}"}]}], ")"}]}], ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              SuperscriptBox["fc", "2"], " ", "2"}]], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["f", "2"], " ", 
              SuperscriptBox["v", "2"], " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "2"], "-", 
                 FractionBox[
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "2"], "-", 
                 FractionBox[
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
                   "2"], "+", 
                 FractionBox[
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
                   "2"]}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "2"], "-", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   RowBox[{
                   "Z", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "2"], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   RowBox[{
                   "Z", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "2"], "+", 
                 FractionBox[
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
                   "2"]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "z", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{
                    "z", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    "Z", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "z", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{
                    "z", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    "Z", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{
                  "z", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
                   " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{
                    "z", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    "Z", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "4", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
                  RowBox[{
                  "Z", "\[LeftDoubleBracket]", "5", 
                   "\[RightDoubleBracket]"}]}]}], ",", "0", ",", "0"}], 
               "}"}]}], ")"}]}]}], "}"}]}], ")"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"d4444423-aefa-41dc-b01d-d0f3cf047539"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Numerical implementation of the Cold Plasma Conductivity Tensor - 4\[Pi]i/\
\[Omega] \[Sigma] for a single species\
\>", "Subsection",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"a863f674-8d13-4e0f-96c8-1662702dfaef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SigmaCold", "[", 
   RowBox[{"fp_", ",", "fc_", ",", "f_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "Eps", "}"}], ",", 
    RowBox[{
     RowBox[{"Eps", "=", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0."}], 
       "}"}]}], ";", 
     RowBox[{
      RowBox[{"Eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "=", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["fp", "2"], 
        RowBox[{
         SuperscriptBox["f", "2"], "-", 
         SuperscriptBox["fc", "2"]}]]}]}], ";", 
     RowBox[{
      RowBox[{"Eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "=", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["fp", "2"], 
        RowBox[{
         SuperscriptBox["f", "2"], "-", 
         SuperscriptBox["fc", "2"]}]]}]}], ";", 
     RowBox[{
      RowBox[{"Eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      "=", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["fp", "2"], 
        SuperscriptBox["f", "2"]]}]}], ";", 
     RowBox[{
      RowBox[{"Eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
      "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"I", " ", "fc", " ", 
         SuperscriptBox["fp", "2"]}], 
        RowBox[{"f", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["f", "2"], "-", 
           SuperscriptBox["fc", "2"]}], ")"}]}]]}]}], ";", "Eps"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7885669995420113`*^9, 3.788567002863599*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"41b540a2-c35e-4920-85f6-e614929e5643"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical implementation of the Z function", "Title",
 CellMargins->{{Inherited, 107}, {Inherited, Inherited}},
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"f3e64a78-1dac-479e-8a5c-86e50c3f9fda"],

Cell["\<\
This implementation uses the representation in terms of error functions for \
small argument |z|<M and asymptotic expansion for argument |z| > M. Now M=4. 
Note: The choice of s in the asymptotic expansion is different from that \
given in the plasma formulary (their sigma).  Use of their sigma clearly \
doesn't work for example when Re[z] =0.  Then sigma must be 0 whereas their \
formula would have sigma=1.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.875804022060878*^9, 3.875804037315428*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"b82b0c53-acd2-4659-9fc4-a82dee7a3b9f"],

Cell[CellGroupData[{

Cell["Z function module", "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"11795471-31af-4671-9852-07fa72c60c45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Zfun", "[", "z0_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "=", "4."}], ",", "s", ",", "y", ",", "q", ",", "z2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"z", "=", 
      RowBox[{"N", "[", "z0", "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "z", "]"}], "<", "M"}], ",", 
       RowBox[{"1.772453851", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          SuperscriptBox["z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Erf", "[", 
           RowBox[{"\[ImaginaryI]", " ", "z"}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"y", "=", 
         RowBox[{"Im", "[", "z", "]"}]}], ";", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"y", "==", "0."}], ",", 
          RowBox[{"s", "=", "1"}], ",", 
          RowBox[{"y", ">", "0"}], ",", 
          RowBox[{"s", "=", "0"}], ",", 
          RowBox[{"y", "<", "0"}], ",", 
          RowBox[{"s", "=", "2"}]}], "]"}], ";", 
        RowBox[{"z2", "=", 
         SuperscriptBox["z", "2"]}], ";", 
        RowBox[{"q", "=", 
         FractionBox[
          RowBox[{"1", "+", 
           FractionBox["1", 
            RowBox[{"2", " ", "z2"}]], "+", 
           FractionBox["3", 
            RowBox[{"4", " ", 
             SuperscriptBox["z2", "2"]}]], "+", 
           FractionBox["15", 
            RowBox[{"8", " ", 
             SuperscriptBox["z2", "3"]}]], "+", 
           FractionBox[
            RowBox[{"7", " ", "15"}], 
            RowBox[{"16", " ", 
             SuperscriptBox["z2", "4"]}]]}], "z"]}], ";", 
        RowBox[{
         RowBox[{"1.772453851", " ", "\[ImaginaryI]", " ", "s", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "z2"}]]}], "-", "q"}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"8ad12e36-0023-4e64-b0eb-9ef935b549fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Gamma parameter of warm plasma theory=1/2 (k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "\[Rho]",
 ")^2\nReturns a list of length TList with an element for each species"
}], "Subsection",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"57a10521-2262-47b1-a3b5-bfe7ff987578"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Warmgamma", "[", 
   RowBox[{"freq_", ",", "B_", ",", "nx_", ",", "TList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "mass", ",", "chg", ",", "fc", ",", "v", ",", 
      "gamma"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"mass", "=", 
      RowBox[{"{", 
       RowBox[{
       "1.", ",", "1836.", ",", "3670.", ",", "5497.", ",", "5496.", ",", 
        "7294."}], "}"}]}], ";", 
     RowBox[{"chg", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1."}], ",", "1.", ",", "1.", ",", "1.", ",", "2.", ",", 
        "2."}], "}"}]}], ";", 
     RowBox[{"gamma", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "TList", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"2.79926", " ", "B0", " ", 
            RowBox[{
            "chg", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           RowBox[{
           "mass", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
          "]"}]}], ";", 
        RowBox[{"v", "=", 
         RowBox[{"N", "[", 
          SqrtBox[
           FractionBox[
            RowBox[{
            "TList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{
             "mass", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             " ", "256"}]]], "]"}]}], ";", 
        RowBox[{
         RowBox[{
         "gamma", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"nx", " ", "freq", " ", "v"}], "fc"], ")"}], "2"], 
          "2."]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "TList", "]"}]}], "}"}]}], "]"}], ";", 
     "gamma"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.8758030899970703`*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"e3b5e8ba-def4-4266-b432-7232a0e5fe7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["S,R.L,D & P functions of cold plasma theory", "Subsection",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"31393097-713b-44b9-93c7-91fe568e06b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SRLDP", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "etaList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "fp", ",", 
      "fc", ",", "R", ",", "L", ",", "S", ",", "d", ",", "P"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"d", "=", 
      FractionBox[
       RowBox[{"R", "-", "L"}], "2."]}], ";", 
     RowBox[{"{", 
      RowBox[{"S", ",", "R", ",", "L", ",", "d", ",", "P"}], "}"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.788800280909318*^9, 3.788800281972652*^9}, 
   3.875802889731574*^9, 3.875803081788562*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"32054a87-1f80-4735-ab21-e995ac9dc4d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["S,R.L functions of cold plasma theory", "Subsection",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"940bc484-da60-43a7-81e3-faaa69fe77f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SRL", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "etaList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "fp", ",", 
      "fc", ",", "R", ",", "L", ",", "S"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", 
      RowBox[{"2", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", 
      RowBox[{"3", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", 
      RowBox[{"3", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", 
      RowBox[{"4", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"{", 
      RowBox[{"S", ",", "R", ",", "L"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.788800247498309*^9, 3.7888002485916147`*^9}, 
   3.87580289903338*^9, 3.875803073917028*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"b412eb23-c7d2-4f82-a8f3-f7cb2a9b1c53"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dispersion relation routines", "Section",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"00add6d2-3b62-48ca-80de-582cf28b0bf0"],

Cell[CellGroupData[{

Cell["\<\
Numerical Implementation of full General Dispersion function 

Uses routine EpsGeneral to provide the dielectric tensor List eps,
a list of length 6 in the order :
  eps {xx, yy, zz, xy, xz, yz} 
List model_List specifies which plasma model is used for a given species :
  \t0 <-> cold plasma
\t1 <-> Warm plasma expanded to 2 nd order
\t2 <-> Warm Plasma with full Bessel functions
\t\tLists nmin_List and nmax_List specify how many harmonic
\t\tare used
\t
 Returns complex value of dispersion function.
  
  \
\>", "Subsection",
 CellChangeTimes->{{3.7850278650423403`*^9, 3.785027870053296*^9}, 
   3.785027921603696*^9, {3.785028036702833*^9, 3.785028063277033*^9}, 
   3.788395967986081*^9},ExpressionUUID->"267e963b-8865-4914-bc83-\
aaed7cc747d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DisFuncGeneral", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "nx_", ",", 
    "etaList_List", ",", "TList_List", ",", "nminList_List", ",", 
    "nmaxList_List", ",", "modelList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eps", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"eps", "=", 
      RowBox[{"EpsGeneral", "[", 
       RowBox[{
       "freq", ",", "ne", ",", "B", ",", "nz", ",", "nx", ",", "etaList", ",",
         "TList", ",", "nminList", ",", "nmaxList", ",", "modelList", ",", 
        "False"}], "]"}]}], ";", 
     RowBox[{"d", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "4"], " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        SuperscriptBox["nz", "4"], " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "-", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "-", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
         " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["nx", "3"], " ", "nz", " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
         "2"]}], "-", 
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{
        SuperscriptBox["nx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["nz", "2"], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "-", 
          RowBox[{
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["nz", "2"], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          "-", 
          RowBox[{
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          "-", 
          SuperscriptBox[
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
           "2"], "+", 
          SuperscriptBox[
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
           "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], "-", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{"nx", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["nz", "3"], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
          "-", 
          RowBox[{"2", " ", "nz", " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
          "+", 
          RowBox[{"2", " ", "nz", " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}]}], 
         ")"}]}]}]}], ";", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["freq", 
         FractionBox[
          RowBox[{"8.98", " ", 
           SqrtBox["ne"]}], 
          SuperscriptBox["10", "3"]]], ")"}], "2"]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.785027961419985*^9, 3.785027989865604*^9}, 
   3.785251257435803*^9, {3.7856051757136087`*^9, 3.785605205372636*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"b1eede1e-c616-4c9d-a635-21322855aa4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Numerical Implementation of full Warm Plasma Dispersion function \n\nYou \
provide a function to calculate the dispersion tensor eps  , a list of length \
6 in the order :\neps{xx,yy,zz,xy,xz,yz}  (e.g. ",
 StyleBox["WarmEpsMaxwell)",
  FontFamily->"Courier",
  FontSize->12],
 "\n\n",
 " ",
 "Returns complex value of dispersion function.\n"
}], "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"78509049-851a-4738-a4e8-5a2e1f271888"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FullDisFunc", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "nx_", ",", 
    "etaList_List", ",", "TList_List", ",", "nminList_List", ",", 
    "nmaxList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eps", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"eps", "=", 
      RowBox[{"WarmEpsMaxwell", "[", 
       RowBox[{
       "freq", ",", "ne", ",", "B", ",", "nz", ",", "nx", ",", "etaList", ",",
         "TList", ",", "nminList", ",", "nmaxList", ",", "False"}], "]"}]}], 
     ";", 
     RowBox[{"d", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "4"], " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        SuperscriptBox["nz", "4"], " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "-", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "-", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
         " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["nx", "3"], " ", "nz", " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], "+", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
         "2"]}], "-", 
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{
        SuperscriptBox["nx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["nz", "2"], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "-", 
          RowBox[{
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["nz", "2"], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          "-", 
          RowBox[{
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          "-", 
          SuperscriptBox[
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
           "2"], "+", 
          SuperscriptBox[
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
           "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{"eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
         " ", 
        RowBox[{
        "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], "-", 
       
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{
        RowBox[{"eps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", 
        SuperscriptBox[
         RowBox[{
         "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
         "2"]}], "+", 
       RowBox[{"nx", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["nz", "3"], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
          "-", 
          RowBox[{"2", " ", "nz", " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
          "+", 
          RowBox[{"2", " ", "nz", " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
           RowBox[{
           "eps", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}]}], 
         ")"}]}]}]}], ";", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["freq", 
         FractionBox[
          RowBox[{"8.98", " ", 
           SqrtBox["ne"]}], 
          SuperscriptBox["10", "3"]]], ")"}], "2"]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.785607305615155*^9, 3.785607308818789*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"b91f364a-67ab-4b43-b36e-c78b61908835"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Numerical Solution of Warm Plasma Dispersion Relation expanded to 2nd order \
in k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "\[Rho].  ",
 "Returns a list of 6 complex roots of the 6th order dispersion equation.\n\
Gets coefficients of k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 " expansion from WarmEpsCoeff\nUses NSolve to solve bi-cubic eq in  k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 StyleBox["2 ",
  FontVariations->{"CompatibilityType"->"Superscript"}],
 StyleBox["then takes square root",
  FontFamily->"Courier",
  FontSize->12],
 "\n"
}], "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"0e37b278-e432-4b1f-912d-5dd57ec85730"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WarmDis6", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List", ",", 
    "TList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eps", ",", "coeffs", ",", "eq", ",", "roots", ",", "n2", ",", "nx"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"eps", "=", 
      RowBox[{"WarmEpsCoeff", "[", 
       RowBox[{
       "freq", ",", "ne", ",", "B", ",", "nz", ",", "etaList", ",", "TList"}],
        "]"}]}], ";", 
     RowBox[{"coeffs", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["nz", "4"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "2"]}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         SuperscriptBox[
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["nz", "3"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"]}], "+", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], "2"]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "4"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{"eps", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "2"]}]}], ",", 
        RowBox[{
         RowBox[{"eps", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         SuperscriptBox[
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "2"], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "2"]}]}]}], 
       "}"}]}], ";", 
     RowBox[{"eq", "=", 
      RowBox[{"coeffs", ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "nx2", ",", 
         SuperscriptBox["nx2", "2"], ",", 
         SuperscriptBox["nx2", "3"]}], "}"}]}]}], ";", 
     RowBox[{"roots", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{"eq", "==", "0"}], ",", "nx2"}], "]"}]}], ";", 
     RowBox[{"n2", "=", 
      RowBox[{"nx2", "/.", "\[InvisibleSpace]", "roots"}]}], ";", 
     RowBox[{"nx", "=", 
      SqrtBox["n2"]}], ";", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"nx", ",", 
        RowBox[{"-", "nx"}]}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"854134e2-bdbe-4c1a-b8c5-78a44a5f2553"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Numerical Implementation of Warm Plasma Dispersion Relation - expanded to \
2nd order in k",
 StyleBox["\[UpTee]",
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "\[Rho].  ",
 "Returns a list of 3 complex roots of the 6th order (i.e. (k^2)^3) \
dispersion equation.\n"
}], "Subsection",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"229a0485-2b70-49a6-adba-d81acfb4871b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WarmDis2", "[", 
   RowBox[{
   "freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List", ",", 
    "TList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eps", ",", "coeffs", ",", "eq", ",", "roots", ",", "n2", ",", "nx"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"eps", "=", 
      RowBox[{"WarmEpsCoeff", "[", 
       RowBox[{
       "freq", ",", "ne", ",", "B", ",", "nz", ",", "etaList", ",", "TList"}],
        "]"}]}], ";", 
     RowBox[{"coeffs", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["nz", "4"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "2"]}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         SuperscriptBox[
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["nz", "3"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"]}], "+", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], "2"]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "4"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{"eps", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", "nz", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "5"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "6"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "2"]}]}], ",", 
        RowBox[{
         RowBox[{"eps", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
         SuperscriptBox[
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "2"], "+", 
         RowBox[{
          RowBox[{"eps", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          SuperscriptBox[
           RowBox[{"eps", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "2"]}]}]}], 
       "}"}]}], ";", 
     RowBox[{"eq", "=", 
      RowBox[{"coeffs", ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "nx2", ",", 
         SuperscriptBox["nx2", "2"], ",", 
         SuperscriptBox["nx2", "3"]}], "}"}]}]}], ";", 
     RowBox[{"roots", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{"eq", "==", "0"}], ",", "nx2"}], "]"}]}], ";", 
     RowBox[{"n2", "=", 
      RowBox[{"nx2", "/.", "\[InvisibleSpace]", "roots"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"27ecd6a0-d592-4537-b9ca-b4fe796dae34"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2nd order cold plasma dispersion relation for fast wave (i.e. Ez=0)\
\>", "Subsection",
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"9afd11dd-66d0-4fa8-a37d-c8df13b8281b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColdDis0", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "fp", ",", 
      "fc", ",", "R", ",", "L", ",", "S"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"R", "-", 
          SuperscriptBox["nz", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"L", "-", 
          SuperscriptBox["nz", "2"]}], ")"}]}], 
       RowBox[{"S", "-", 
        SuperscriptBox["nz", "2"]}]]]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.875802939744089*^9, 3.8758030588162603`*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"49a04cc9-522a-4e34-9f76-156fb4f73b66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation ColdDis2PM\nreturns ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", "x", "2"], TraditionalForm]],ExpressionUUID->
  "184b6508-335f-40e8-ab2d-fbe5bc19f38c"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "12ae0a15-d3b6-4f5f-8937-6145c6695bbe"],
 ") {+ root, - root}"
}], "Subsection",
 CellChangeTimes->{
  3.8629549281469*^9, {3.8629549668270407`*^9, 3.862955020616287*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"4d0a0268-839b-4bab-80a2-1c1a93169f6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nxSqColdDisPM", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "R", ",", "L",
       ",", "S", ",", "P", ",", "a", ",", "b", ",", "c", ",", "discr", ",", 
      "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "S"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"P", " ", "S"}], "+", 
         RowBox[{"L", " ", "R"}]}], ")"}]}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"P", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["nz", "4"], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R", "+", "L"}], ")"}], " ", 
          SuperscriptBox["nz", "2"]}], "+", 
         RowBox[{"R", " ", "L"}]}], ")"}]}]}], ";", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "+", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", 
     RowBox[{"rootM", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "-", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", 
     RowBox[{"{", 
      RowBox[{"rootP", ",", "rootM"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.875802952645029*^9, 3.875803047485218*^9, 3.875803256271741*^9, {
   3.875885505678308*^9, 3.875885520741066*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"cc2334da-ff0a-4a5a-90a9-ec9df0ad0e60"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation nxColdDisPM\nreturns ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "dd39bee9-ba3f-47e3-94e7-fc6d22587a56"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "b49c4e62-3af3-405f-989a-1fd27c92cad4"],
 ") {+ root, - root}"
}], "Subsection",
 CellChangeTimes->{
  3.8629549281469*^9, {3.8629549668270407`*^9, 3.862955020616287*^9}, {
   3.863633489229774*^9, 3.863633503517734*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"84fdba2b-a59f-4c26-9fba-cc0ea83e8f73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nxColdDisPM", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "R", ",", "L",
       ",", "S", ",", "P", ",", "a", ",", "b", ",", "c", ",", "discr", ",", 
      "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "S"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"P", " ", "S"}], "+", 
         RowBox[{"L", " ", "R"}]}], ")"}]}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"P", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["nz", "4"], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R", "+", "L"}], ")"}], " ", 
          SuperscriptBox["nz", "2"]}], "+", 
         RowBox[{"R", " ", "L"}]}], ")"}]}]}], ";", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "+", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", 
     RowBox[{"rootM", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "-", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", 
     RowBox[{"{", 
      RowBox[{"rootP", ",", "rootM"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8636334384687243`*^9, 3.8636334535671177`*^9}, {
   3.863633826189492*^9, 3.863633826548345*^9}, 3.875803898660796*^9, 
   3.8758039297571573`*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"f1a366db-fa29-43d3-8e40-bbabaceb0330"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation ColdDis2PM\nreturns ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", "x", "2"], TraditionalForm]],ExpressionUUID->
  "b1fd941b-9e75-44b9-b0b7-6d055bdab271"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "ce1158dd-d2ff-4fbc-ba49-28da4333d505"],
 ") {fast root, slow root}\nThe fast root is defined here as root with \
smaller |",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "c71096b7-9173-46b7-830c-d53e823b09ce"],
 "|",
 StyleBox["\n",
  FontSize->18]
}], "Subsection",
 CellChangeTimes->{{3.862955042759418*^9, 3.862955079862136*^9}, {
  3.875803318427717*^9, 3.875803320510497*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"3aed42b8-ef85-4f5a-93d0-25bf59396af7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nxSqColdDisFS", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "fp", ",", "fc", ",", 
      "chg", ",", "R", ",", "L", ",", "S", ",", "P", ",", "a", ",", "b", ",", 
      "c", ",", "discr", ",", "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", 
      RowBox[{"2", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", 
      RowBox[{"3", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", 
      RowBox[{"3", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", 
      RowBox[{"4", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "S"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"P", " ", "S"}], "+", 
         RowBox[{"L", " ", "R"}]}], ")"}]}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"P", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["nz", "4"], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R", "+", "L"}], ")"}], " ", 
          SuperscriptBox["nz", "2"]}], "+", 
         RowBox[{"R", " ", "L"}]}], ")"}]}]}], ";", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "+", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", 
     RowBox[{"rootM", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "-", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "rootP", "]"}], "<", 
        RowBox[{"Abs", "[", "rootM", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"rootP", ",", "rootM"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rootM", ",", "rootP"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.875802962902583*^9, 3.875803036209257*^9, 3.8758033354395313`*^9, {
   3.8758855500723*^9, 3.875885556634839*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"3069a389-c373-49ec-a61a-79e0c313a738"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation nxColdDisFS\nReturns ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "b9581ea5-f638-4437-837e-6ff2a61aeacc"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "19f62b7b-4796-417d-aa04-576fc3c5c6d6"],
 ") {fast root, slow root}\nThe fast root is defined here as root with \
smaller |",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "deedb1fa-5343-44bb-8f0f-c187fdebd897"],
 "|"
}], "Subsection",
 CellChangeTimes->{{3.862955042759418*^9, 3.862955079862136*^9}, {
   3.863633594309656*^9, 3.863633617171712*^9}, {3.8636337044783907`*^9, 
   3.8636337224783287`*^9}, 3.8636340511096687`*^9, {3.86363413310509*^9, 
   3.863634133735203*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"918a07a2-c11a-4864-9fda-e0817d2e9bee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nxColdDisFS", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nz_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "fp", ",", "fc", ",", 
      "chg", ",", "R", ",", "L", ",", "S", ",", "P", ",", "a", ",", "b", ",", 
      "c", ",", "discr", ",", "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", 
      RowBox[{"2", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", 
      RowBox[{"3", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", 
      RowBox[{"3", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", 
      RowBox[{"4", " ", "1836."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "S"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"P", " ", "S"}], "+", 
         RowBox[{"L", " ", "R"}]}], ")"}]}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"P", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["nz", "4"], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R", "+", "L"}], ")"}], " ", 
          SuperscriptBox["nz", "2"]}], "+", 
         RowBox[{"R", " ", "L"}]}], ")"}]}]}], ";", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "+", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", 
     RowBox[{"rootM", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "-", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "rootP", "]"}], "<", 
        RowBox[{"Abs", "[", "rootM", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"rootP", ",", "rootM"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rootM", ",", "rootP"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.86363404024362*^9, 3.863634045149078*^9}, 
   3.875803879239293*^9, 3.87580394405582*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"573b3027-3489-4848-a3c4-eb2d73ccd222"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation ColdDisNzSquareOfNxPM\n\
returns ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", "z", "2"], TraditionalForm]],ExpressionUUID->
  "8a832c8d-89a0-4876-aedf-f8e18c1844b4"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "1ac10375-5729-4798-a8df-c63b9d0908c4"],
 ") {+ root, - root}"
}], "Subsection",
 CellChangeTimes->{
  3.8629549281469*^9, {3.8629549668270407`*^9, 3.862955020616287*^9}, {
   3.862955115211795*^9, 3.862955118296421*^9}, {3.862956582463799*^9, 
   3.862956615313006*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"60d088c5-2891-43ee-a167-bb0636d72bc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nzSqColdDisPM", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nx_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "R", ",", "L",
       ",", "S", ",", "P", ",", "a", ",", "b", ",", "c", ",", "discr", ",", 
      "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "P"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"P", 
        RowBox[{"(", 
         RowBox[{"R", "+", "L"}], ")"}]}]}]}], ";", 
     RowBox[{"c", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S", " ", 
         SuperscriptBox["nx", "4"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"P", " ", "S"}], "+", " ", 
           RowBox[{"R", " ", "L"}]}], ")"}], " ", 
         SuperscriptBox["nx", "2"]}], "+", 
        RowBox[{"P", " ", "R", " ", "L"}]}], ")"}]}], ";", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "+", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", 
     RowBox[{"rootM", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "-", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", 
     RowBox[{"{", 
      RowBox[{"rootP", ",", "rootM"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.862955128757725*^9, {3.862955210436077*^9, 3.862955343327771*^9}, {
   3.862955382186983*^9, 3.862955405724165*^9}, {3.862955436932723*^9, 
   3.862955533146514*^9}, 3.862955936185883*^9, {3.862955981953656*^9, 
   3.862956016942793*^9}, {3.8629560585696907`*^9, 3.862956102423592*^9}, {
   3.8629561652496*^9, 3.862956173663558*^9}, {3.863446482204957*^9, 
   3.863446539965761*^9}, 3.8758029796901073`*^9, 3.8758030247318487`*^9, 
   3.87580345005624*^9, {3.875885583526353*^9, 3.875885589462763*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"e903da30-9c19-4065-a1de-fbb95982eaf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation nzColdDisPM\nReturns ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "665e6640-782e-462b-aa44-d7451e1f51ed"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "e0a3feca-c74f-452c-bc9d-a9a9a98b5805"],
 ") {+ root, - root}"
}], "Subsection",
 CellChangeTimes->{
  3.8629549281469*^9, {3.8629549668270407`*^9, 3.862955020616287*^9}, {
   3.862955115211795*^9, 3.862955118296421*^9}, {3.862956582463799*^9, 
   3.862956615313006*^9}, {3.8636349401390533`*^9, 3.863634958706841*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"d9db6e17-c1b6-4b8b-a0ce-45e07545a814"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nzColdDisPM", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nx_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "R", ",", "L",
       ",", "S", ",", "P", ",", "a", ",", "b", ",", "c", ",", "discr", ",", 
      "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "P"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"P", 
        RowBox[{"(", 
         RowBox[{"R", "+", "L"}], ")"}]}]}]}], ";", 
     RowBox[{"c", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S", " ", 
         SuperscriptBox["nx", "4"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"P", " ", "S"}], "+", " ", 
           RowBox[{"R", " ", "L"}]}], ")"}], " ", 
         SuperscriptBox["nx", "2"]}], "+", 
        RowBox[{"P", " ", "R", " ", "L"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "+", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", 
     RowBox[{"rootM", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "-", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", 
     RowBox[{"{", 
      RowBox[{"rootP", ",", "rootM"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.862955128757725*^9, {3.862955210436077*^9, 3.862955343327771*^9}, {
   3.862955382186983*^9, 3.862955405724165*^9}, {3.862955436932723*^9, 
   3.862955533146514*^9}, 3.862955936185883*^9, {3.862955981953656*^9, 
   3.862956016942793*^9}, {3.8629560585696907`*^9, 3.862956102423592*^9}, {
   3.8629561652496*^9, 3.862956173663558*^9}, {3.863446482204957*^9, 
   3.863446539965761*^9}, {3.863611951273753*^9, 3.863611971748958*^9}, {
   3.863612921658676*^9, 3.863612922287002*^9}, {3.863634919126031*^9, 
   3.863634926279723*^9}, 3.875803861460147*^9, 3.875803960040699*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"156036f6-0997-4929-bd31-9001c7f5a04d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation ColdDisNzSquareOfNxFS\n\
returns ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", "z", "2"], TraditionalForm]],ExpressionUUID->
  "8c8e6caf-43a5-4ae8-bf72-4d691ac853e6"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "03642be2-b446-47ed-9e9c-44b577b6a72e"],
 ") {fast root, slow root}\n the fast root is defined here as root with \
smaller |",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "8af57dbb-659d-4aa3-8d8c-1112a6d0ca4a"],
 "|"
}], "Subsection",
 CellChangeTimes->{
  3.8629549281469*^9, {3.8629549668270407`*^9, 3.862955020616287*^9}, {
   3.862955115211795*^9, 3.862955118296421*^9}, {3.862956582463799*^9, 
   3.862956615313006*^9}, {3.862956740535845*^9, 3.8629567493757677`*^9}, {
   3.8630311978024073`*^9, 3.8630311985225077`*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"12563b8a-9c6e-4c7d-bfb8-11cf4aee13ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nzSqColdDisFS", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nx_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "R", ",", "L",
       ",", "S", ",", "P", ",", "a", ",", "b", ",", "c", ",", "discr", ",", 
      "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "P"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"P", 
        RowBox[{"(", 
         RowBox[{"R", "+", "L"}], ")"}]}]}]}], ";", 
     RowBox[{"c", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S", " ", 
         SuperscriptBox["nx", "4"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"P", " ", "S"}], "+", " ", 
           RowBox[{"R", " ", "L"}]}], ")"}], " ", 
         SuperscriptBox["nx", "2"]}], "+", 
        RowBox[{"P", " ", "R", " ", "L"}]}], ")"}]}], ";", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "+", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", 
     RowBox[{"rootM", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "b"}], "-", "discr"}], 
       RowBox[{"2", " ", "a"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "rootP", "]"}], "<", 
        RowBox[{"Abs", "[", "rootM", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"rootP", ",", "rootM"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rootM", ",", "rootP"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.862955128757725*^9, {3.862955210436077*^9, 3.862955343327771*^9}, {
   3.862955382186983*^9, 3.862955405724165*^9}, {3.862955436932723*^9, 
   3.862955533146514*^9}, 3.862955936185883*^9, {3.862955981953656*^9, 
   3.862956016942793*^9}, {3.8629560585696907`*^9, 3.862956102423592*^9}, {
   3.8629561652496*^9, 3.862956173663558*^9}, {3.862956783466771*^9, 
   3.862956785132121*^9}, 3.86295682408317*^9, 3.86295687115352*^9, {
   3.863031190762562*^9, 3.863031191528283*^9}, {3.8634465980653267`*^9, 
   3.863446605932271*^9}, {3.8758029932497997`*^9, 3.875803014049243*^9}, 
   3.8758034982511377`*^9, {3.875885627564164*^9, 3.875885636667818*^9}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"c10e275e-f005-4a29-8dff-e1e27bc8cb7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n\n\n4th Order cold plasma dispersion relation nzSqColdDisFS\nReturns ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "a1754826-cdf3-4cfe-80a6-937daa418932"],
 " (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "x"], TraditionalForm]],ExpressionUUID->
  "1ae85f5b-3630-40f3-aeb3-1b95314ec60a"],
 ") {fast root, slow root}\nThe fast root is defined here as root with \
smaller |",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "z"], TraditionalForm]],ExpressionUUID->
  "a434a5a1-66f1-4d73-a001-af07f57f3c78"],
 "|"
}], "Subsection",
 CellChangeTimes->{
  3.8629549281469*^9, {3.8629549668270407`*^9, 3.862955020616287*^9}, {
   3.862955115211795*^9, 3.862955118296421*^9}, {3.862956582463799*^9, 
   3.862956615313006*^9}, {3.862956740535845*^9, 3.8629567493757677`*^9}, {
   3.8630311978024073`*^9, 3.8630311985225077`*^9}, {3.863634999294353*^9, 
   3.863635023332984*^9}, {3.8636350886480827`*^9, 3.8636350900655537`*^9}},
 ImageRegion->{{0, 1}, {0, 
  1}},ExpressionUUID->"04f3225c-110e-4f99-8742-27faa023b2b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nzColdDisFS", "[", 
   RowBox[{"freq_", ",", "ne_", ",", "B_", ",", "nx_", ",", "etaList_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n0", ",", "B0", ",", "eta", ",", "mass", ",", "chg", ",", "R", ",", "L",
       ",", "S", ",", "P", ",", "a", ",", "b", ",", "c", ",", "discr", ",", 
      "rootP", ",", "rootM"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n0", "=", 
      FractionBox["ne", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"B0", "=", 
      RowBox[{"B", " ", 
       SuperscriptBox["10", "4"]}]}], ";", 
     RowBox[{
      RowBox[{"eta", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "[", "i", "]"}], "=", 
        RowBox[{
        "etaList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "0", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "1", "]"}], "=", "1836."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "2", "]"}], "=", "3670."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "3", "]"}], "=", "5497."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "4", "]"}], "=", "5496."}], ";", 
     RowBox[{
      RowBox[{"mass", "[", "5", "]"}], "=", "7294."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "0", "]"}], "=", 
      RowBox[{"-", "1."}]}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "1", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "2", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "3", "]"}], "=", "1."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "4", "]"}], "=", "2."}], ";", 
     RowBox[{
      RowBox[{"chg", "[", "5", "]"}], "=", "2."}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fp", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"8.9787", " ", 
          SqrtBox[
           FractionBox[
            RowBox[{"n0", " ", 
             RowBox[{"eta", "[", "i", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"chg", "[", "i", "]"}], "2"]}], 
            RowBox[{"mass", "[", "i", "]"}]]]}], 
         SuperscriptBox["10", "3"]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fc", "[", "i", "]"}], "=", 
        FractionBox[
         RowBox[{"2.79926", " ", "B0", " ", 
          RowBox[{"chg", "[", "i", "]"}]}], 
         RowBox[{"mass", "[", "i", "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], ";", 
     RowBox[{"R", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "+", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{"freq", " ", 
          RowBox[{"(", 
           RowBox[{"freq", "-", 
            RowBox[{"fc", "[", "i", "]"}]}], ")"}]}]]}]}]}], ";", 
     RowBox[{"S", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         RowBox[{
          SuperscriptBox["freq", "2"], "-", 
          SuperscriptBox[
           RowBox[{"fc", "[", "i", "]"}], "2"]}]]}]}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"1", "-", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "5"], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"fp", "[", "i", "]"}], "2"], 
         SuperscriptBox["freq", "2"]]}]}]}], ";", 
     RowBox[{"a", "=", "P"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["nx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"S", "+", "P"}], ")"}]}], "-", 
       RowBox[{"P", 
        RowBox[{"(", 
         RowBox[{"R", "+", "L"}], ")"}]}]}]}], ";", 
     RowBox[{"c", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S", " ", 
         SuperscriptBox["nx", "4"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"P", " ", "S"}], "+", " ", 
           RowBox[{"R", " ", "L"}]}], ")"}], " ", 
         SuperscriptBox["nx", "2"]}], "+", 
        RowBox[{"P", " ", "R", " ", "L"}]}], ")"}]}], ";", 
     RowBox[{"discr", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["b", "2"], "-", 
        RowBox[{"4", " ", "a", " ", "c"}]}]]}], ";", 
     RowBox[{"rootP", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "+", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", 
     RowBox[{"rootM", "=", 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"-", "b"}], "-", "discr"}], 
        RowBox[{"2", " ", "a"}]]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "rootP", "]"}], "<", 
        RowBox[{"Abs", "[", "rootM", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"rootP", ",", "rootM"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rootM", ",", "rootP"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.862955128757725*^9, {3.862955210436077*^9, 3.862955343327771*^9}, {
   3.862955382186983*^9, 3.862955405724165*^9}, {3.862955436932723*^9, 
   3.862955533146514*^9}, 3.862955936185883*^9, {3.862955981953656*^9, 
   3.862956016942793*^9}, {3.8629560585696907`*^9, 3.862956102423592*^9}, {
   3.8629561652496*^9, 3.862956173663558*^9}, {3.862956783466771*^9, 
   3.862956785132121*^9}, 3.86295682408317*^9, 3.86295687115352*^9, {
   3.863031190762562*^9, 3.863031191528283*^9}, {3.8634465980653267`*^9, 
   3.863446605932271*^9}, {3.86363497837236*^9, 3.8636349900257587`*^9}, {
   3.8636350942293587`*^9, 3.863635094656906*^9}, 3.8758038455156193`*^9, 
   3.875803977170533*^9},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"1ca5ec8d-17ca-4b1b-b367-94d1fe6fb5b4"]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowToolbars->{},
CellGrouping->Manual,
WindowSize->{1184, 916},
WindowMargins->{{138, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
ShowCellLabel->True,
ShowCellTags->False,
Magnification:>1.25 Inherited,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2241adfa-dfbc-4ea0-9898-b442e0c1c919"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 135, 2, 85, "Section",ExpressionUUID->"4c07a981-1626-465d-a361-89b0e114aaf8"],
Cell[CellGroupData[{
Cell[740, 28, 730, 19, 287, "Subsection",ExpressionUUID->"23d301b4-2a38-47bf-afa0-38ea5607f174",
 InitializationCell->True],
Cell[1473, 49, 9483, 235, 1053, "Input",ExpressionUUID->"c66a0ab7-6d9d-4b31-a20e-ddb6d9566b99",
 PageBreakBelow->True,
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10993, 289, 438, 11, 146, "Subsection",ExpressionUUID->"93ba5263-cd61-4bb7-8943-8a4f731bae49",
 InitializationCell->True],
Cell[11434, 302, 6536, 166, 990, "Input",ExpressionUUID->"bc747b7a-3cd6-41c9-9cde-b01b8465ef9e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[18007, 473, 325, 8, 105, "Subsection",ExpressionUUID->"73492aab-32eb-4fee-a3b6-55d788c86d59"],
Cell[18335, 483, 4545, 124, 560, "Input",ExpressionUUID->"30ff4dcc-20e6-4b1b-bf9c-a247d5314569",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[22917, 612, 526, 14, 116, "Subsection",ExpressionUUID->"260a69c4-805b-437a-ac00-46c903af2668",
 InitializationCell->True],
Cell[23446, 628, 5379, 149, 886, "Input",ExpressionUUID->"b82aa548-fc2d-4d4a-91a7-ef510b0f427b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[28862, 782, 720, 19, 179, "Subsection",ExpressionUUID->"0aee45b7-8b52-485f-92d6-1ea03f441637",
 InitializationCell->True],
Cell[29585, 803, 5204, 137, 814, "Input",ExpressionUUID->"3de698c4-bc56-4519-941e-d3bf67251d33",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[34826, 945, 283, 7, 65, "Subsection",ExpressionUUID->"27cd580f-41b3-471b-8c55-6a8094217a30",
 InitializationCell->True],
Cell[35112, 954, 9841, 252, 450, "Input",ExpressionUUID->"d4444423-aefa-41dc-b01d-d0f3cf047539",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[44990, 1211, 234, 5, 44, "Subsection",ExpressionUUID->"a863f674-8d13-4e0f-96c8-1662702dfaef"],
Cell[45227, 1218, 1779, 54, 322, "Input",ExpressionUUID->"41b540a2-c35e-4920-85f6-e614929e5643",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47055, 1278, 234, 4, 97, "Title",ExpressionUUID->"f3e64a78-1dac-479e-8a5c-86e50c3f9fda",
 InitializationCell->True],
Cell[47292, 1284, 618, 11, 74, "Text",ExpressionUUID->"b82b0c53-acd2-4659-9fc4-a82dee7a3b9f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[47935, 1299, 156, 3, 44, "Subsection",ExpressionUUID->"11795471-31af-4671-9852-07fa72c60c45",
 InitializationCell->True],
Cell[48094, 1304, 2101, 60, 249, "Input",ExpressionUUID->"8ad12e36-0023-4e64-b0eb-9ef935b549fb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[50232, 1369, 332, 8, 76, "Subsection",ExpressionUUID->"57a10521-2262-47b1-a3b5-bfe7ff987578"],
Cell[50567, 1379, 2574, 74, 413, "Input",ExpressionUUID->"e3b5e8ba-def4-4266-b432-7232a0e5fe7f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[53178, 1458, 155, 2, 44, "Subsection",ExpressionUUID->"31393097-713b-44b9-93c7-91fe568e06b7"],
Cell[53336, 1462, 4633, 135, 917, "Input",ExpressionUUID->"32054a87-1f80-4735-ab21-e995ac9dc4d3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[58006, 1602, 149, 2, 44, "Subsection",ExpressionUUID->"940bc484-da60-43a7-81e3-faaa69fe77f3"],
Cell[58158, 1606, 4317, 126, 808, "Input",ExpressionUUID->"b412eb23-c7d2-4f82-a8f3-f7cb2a9b1c53",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[62512, 1737, 137, 2, 85, "Section",ExpressionUUID->"00add6d2-3b62-48ca-80de-582cf28b0bf0"],
Cell[CellGroupData[{
Cell[62674, 1743, 764, 20, 328, "Subsection",ExpressionUUID->"267e963b-8865-4914-bc83-aaed7cc747d0"],
Cell[63441, 1765, 5944, 164, 278, "Input",ExpressionUUID->"b1eede1e-c616-4c9d-a635-21322855aa4d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[69422, 1934, 495, 13, 166, "Subsection",ExpressionUUID->"78509049-851a-4738-a4e8-5a2e1f271888",
 InitializationCell->True],
Cell[69920, 1949, 5859, 164, 278, "Input",ExpressionUUID->"b91f364a-67ab-4b43-b36e-c78b61908835",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[75816, 2118, 814, 22, 158, "Subsection",ExpressionUUID->"0e37b278-e432-4b1f-912d-5dd57ec85730",
 InitializationCell->True],
Cell[76633, 2142, 16790, 346, 567, "Input",ExpressionUUID->"854134e2-bdbe-4c1a-b8c5-78a44a5f2553",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[93460, 2493, 430, 11, 96, "Subsection",ExpressionUUID->"229a0485-2b70-49a6-adba-d81acfb4871b",
 InitializationCell->True],
Cell[93893, 2506, 16612, 341, 507, "Input",ExpressionUUID->"27ecd6a0-d592-4537-b9ca-b4fe796dae34",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[110542, 2852, 187, 4, 44, "Subsection",ExpressionUUID->"9afd11dd-66d0-4fa8-a37d-c8df13b8281b"],
Cell[110732, 2858, 4429, 131, 845, "Input",ExpressionUUID->"49a04cc9-522a-4e34-9f76-156fb4f73b66",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[115198, 2994, 588, 16, 130, "Subsection",ExpressionUUID->"4d0a0268-839b-4bab-80a2-1c1a93169f6f"],
Cell[115789, 3012, 5716, 170, 1097, "Input",ExpressionUUID->"cc2334da-ff0a-4a5a-90a9-ec9df0ad0e60",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121566, 3189, 629, 17, 125, "Subsection",ExpressionUUID->"84fdba2b-a59f-4c26-9fba-cc0ea83e8f73"],
Cell[122198, 3208, 5785, 172, 1128, "Input",ExpressionUUID->"f1a366db-fa29-43d3-8e40-bbabaceb0330",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[128020, 3385, 844, 24, 176, "Subsection",ExpressionUUID->"3aed42b8-ef85-4f5a-93d0-25bf59396af7"],
Cell[128867, 3411, 6094, 182, 1097, "Input",ExpressionUUID->"3069a389-c373-49ec-a61a-79e0c313a738",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[134998, 3598, 930, 24, 146, "Subsection",ExpressionUUID->"918a07a2-c11a-4864-9fda-e0817d2e9bee"],
Cell[135931, 3624, 6100, 183, 1128, "Input",ExpressionUUID->"573b3027-3489-4848-a3c4-eb2d73ccd222",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[142068, 3812, 701, 19, 130, "Subsection",ExpressionUUID->"60d088c5-2891-43ee-a167-bb0636d72bc5"],
Cell[142772, 3833, 6149, 176, 1097, "Input",ExpressionUUID->"e903da30-9c19-4065-a1de-fbb95982eaf3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[148958, 4014, 727, 18, 125, "Subsection",ExpressionUUID->"d9db6e17-c1b6-4b8b-a0ce-45e07545a814"],
Cell[149688, 4034, 6287, 180, 1128, "Input",ExpressionUUID->"156036f6-0997-4929-bd31-9001c7f5a04d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[156012, 4219, 1003, 26, 151, "Subsection",ExpressionUUID->"12563b8a-9c6e-4c7d-bfb8-11cf4aee13ea"],
Cell[157018, 4247, 6567, 186, 1097, "Input",ExpressionUUID->"c10e275e-f005-4a29-8dff-e1e27bc8cb7b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[163622, 4438, 1082, 26, 146, "Subsection",ExpressionUUID->"04f3225c-110e-4f99-8742-27faa023b2b2"],
Cell[164707, 4466, 6632, 189, 1128, "Input",ExpressionUUID->"1ca5ec8d-17ca-4b1b-b367-94d1fe6fb5b4",
 InitializationCell->True]
}, Open  ]]
}
]
*)

